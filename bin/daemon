#!/usr/bin/env node
const finalPM = require('../');

finalPM.registerProcessHandlers();

const instance = new finalPM.daemon();

process.on('SIGTERM', () => {
    instance.kill();
});

process.on('SIGINT', () => {
    instance.kill();
});

instance.on('kill', () => {
    console.log("Daemon stopped.");
});

run();

async function run() {
    await instance.listen(process.argv[2]);

    console.log("Daemon running.");
    process.send('ready');
}
